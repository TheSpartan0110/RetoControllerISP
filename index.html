<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refactoring Challenge - Patr√≥n Controller</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Inter:wght@400;500;600;700&display=swap');
        
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .font-inter { font-family: 'Inter', sans-serif; }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse-success {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(34, 197, 94, 0.5); }
            50% { box-shadow: 0 0 20px rgba(34, 197, 94, 0.8); }
        }
        
        .slide-in { animation: slideIn 0.5s ease-out; }
        .pulse-success { animation: pulse-success 0.6s ease-in-out; }
        .shake { animation: shake 0.5s ease-in-out; }
        .glow { animation: glow 2s ease-in-out infinite; }
        
        .code-snippet {
            background: linear-gradient(135deg, #1e293b, #334155);
            border: 2px solid #475569;
            transition: all 0.3s ease;
        }
        
        .code-snippet:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }
        
        .code-snippet.dragging {
            opacity: 0.7;
            transform: rotate(2deg) scale(0.95);
        }
        
        .drop-zone {
            background: linear-gradient(135deg, #374151, #4b5563);
            border: 2px dashed #6b7280;
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            border-color: #10b981;
            background: linear-gradient(135deg, #065f46, #047857);
        }
        
        .drop-zone.filled {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-color: #22c55e;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 min-h-screen font-inter">
    <!-- Header -->
    <div class="container mx-auto px-4 py-6">
        <div class="text-center mb-8">
            <div class="flex items-center justify-center mb-4">
                <div class="text-4xl mr-3">üîß</div>
                <h1 class="text-4xl font-bold text-white">Refactoring Challenge</h1>
                <div class="text-4xl ml-3">‚ö°</div>
            </div>
            <p id="subtitle" class="text-xl text-gray-300 mb-4">Transforma el c√≥digo malo aplicando el patr√≥n Controller</p>
            
            <!-- Progress Bar -->
            <div class="max-w-md mx-auto mb-6">
                <div class="flex justify-between text-sm text-gray-400 mb-2">
                    <span>Progreso</span>
                    <span id="progressText">0/7 completado</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-3">
                    <div id="progressBar" class="progress-bar h-3 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="flex items-center justify-center space-x-4 flex-wrap gap-2">
                <div class="flex space-x-2">
                    <button id="controllerBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                        üîß Controller
                    </button>
                    <button id="ispBtn" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                        üîó ISP
                    </button>
                </div>
                <button id="showHintBtn" class="bg-yellow-500 hover:bg-yellow-600 text-black px-4 py-2 rounded-lg font-semibold transition-colors">
                    üí° Mostrar Pista
                </button>
                <button id="resetBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                    üîÑ Reiniciar
                </button>
                <!-- <button id="showSolutionBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                    üëÅÔ∏è Ver Soluci√≥n
                </button> -->
            </div>
        </div>

        <!-- Hint Panel -->
        <div id="hintPanel" class="hidden mb-8 p-6 bg-gradient-to-r from-yellow-900 to-orange-900 rounded-xl border border-yellow-600">
            <h3 class="text-xl font-bold text-yellow-400 mb-4">üí° Pista - Patr√≥n Controller</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm">
                <div>
                    <h4 class="text-red-400 font-bold mb-2">‚ùå Problema Actual:</h4>
                    <ul class="text-red-200 space-y-1">
                        <li>‚Ä¢ Una sola clase hace todo</li>
                        <li>‚Ä¢ Mezcla UI, l√≥gica y datos</li>
                        <li>‚Ä¢ Dif√≠cil de mantener y testear</li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-green-400 font-bold mb-2">‚úÖ Soluci√≥n Controller:</h4>
                    <ul class="text-green-200 space-y-1">
                        <li>‚Ä¢ Separar responsabilidades</li>
                        <li>‚Ä¢ Crear controladores espec√≠ficos</li>
                        <li>‚Ä¢ Usar modelos para datos</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <!-- 1. C√≥digo Sin Controller (centrado y primero) -->
<div class="max-w-2xl mx-auto mb-8">
    <h2 class="text-2xl font-bold text-red-400 mb-6 flex items-center justify-center">
        <span class="text-3xl mr-3">‚ùå</span>
        C√≥digo Sin Controller
    </h2>
    <div class="bg-gradient-to-br from-red-900 to-red-800 p-6 rounded-xl border border-red-600">
        <pre class="text-red-100 text-sm font-mono overflow-x-auto"><code># C√≥digo sin aplicar Controller
class Restaurant:
    def take_order(self):
        name = input("üë§ Ingrese su nombre: ")
        item = input("üçΩÔ∏è ¬øQu√© desea ordenar (Pizza / Pasta / Ensalada)? ")
        print(f"Cliente {name} orden√≥ {item}")
        
        # Cocina
        print(f"Preparando {item} en la cocina...")
        
        # Factura
        print(f"Generando factura para {name} por {item}...")
        print("‚úÖ Pedido completado.")

# Uso
restaurant = Restaurant()
restaurant.take_order()</code></pre>
    </div>
</div>

<!-- 2. Fragmentos y C√≥digo Bueno en paralelo -->
<div class="grid lg:grid-cols-2 gap-8 mb-12">
    <!-- üß© Fragmentos de C√≥digo -->
    <div>
        <h3 class="text-lg font-bold text-white mb-3 flex items-center">
            <span class="text-2xl mr-2">üß©</span>
            Fragmentos de C√≥digo
        </h3>
        <p class="text-gray-300 text-sm mb-4">Arrastra estos fragmentos al c√≥digo correcto:</p>
        <div id="codeFragments" class="space-y-3">
            <!-- Los fragmentos se generan din√°micamente -->
        </div>
    </div>
    <!-- ‚úÖ C√≥digo Con Controller -->
    <div>
        <h2 class="text-2xl font-bold text-green-400 mb-6 flex items-center">
            <span class="text-3xl mr-3">‚úÖ</span>
            C√≥digo Con Controller
        </h2>
        <div class="bg-gradient-to-br from-green-900 to-green-800 p-6 rounded-xl border border-green-600">
            <pre class="text-green-100 text-sm font-mono overflow-x-auto"><code id="goodCode"></code></pre>
        </div>
    </div>
</div>

<!-- 3. Secci√≥n Monaco Editor Controller -->
<div class="max-w-3xl mx-auto">
    <!-- Secci√≥n Controller -->
    <div id="controllerSection" class="mt-12 bg-gradient-to-br from-gray-900 to-gray-800 p-6 rounded-xl border border-gray-700 max-w-3xl mx-auto">
        <h2 class="text-xl font-bold text-white mb-2 flex items-center">
            <span class="text-2xl mr-2">‚úçÔ∏è</span>
            Escribe tu soluci√≥n Controller aqu√≠
        </h2>
        <div id="controllerEditor" style="height:300px;border-radius:8px;border:1px solid #334155;"></div>
        <button onclick="checkController()" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg font-semibold transition-colors">
            Evaluar mi soluci√≥n Controller
        </button>
        <div id="controllerFeedback" class="mt-4 text-sm bg-gray-700 text-white p-3 rounded"></div>
    </div>
    <!-- Secci√≥n ISP -->
    <div id="ispSection" class="mt-12 bg-gradient-to-br from-gray-900 to-gray-800 p-6 rounded-xl border border-gray-700 hidden">
        <h2 class="text-xl font-bold text-white mb-2 flex items-center">
            <span class="text-2xl mr-2">üîó</span>
            Escribe tu soluci√≥n ISP aqu√≠
        </h2>
        <div id="ispEditor" style="height:300px;border-radius:8px;border:1px solid #334155;"></div>
        <button onclick="checkISP()" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-lg font-semibold transition-colors">
            Evaluar mi soluci√≥n ISP
        </button>
        <div id="ispFeedback" class="mt-4 text-sm bg-gray-700 text-white p-3 rounded"></div>
    </div>
</div>

        <!-- Success Modal -->
        <div id="successModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-gradient-to-br from-green-500 to-emerald-600 p-8 rounded-2xl text-center max-w-lg mx-4 relative">
                <button id="minimizeSuccessBtn" class="absolute top-3 right-3 text-white hover:text-green-200 text-2xl font-bold" title="Minimizar">&minus;</button>
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-3xl font-bold text-white mb-4">¬°Refactoring Completado!</h3>
                <p class="text-xl text-green-100 mb-6">Has aplicado exitosamente el patr√≥n Controller. El c√≥digo ahora tiene:</p>
                <ul class="text-left text-green-100 mb-6 space-y-2">
                    <li>‚úÖ Separaci√≥n de responsabilidades</li>
                    <li>‚úÖ Controladores espec√≠ficos</li>
                    <li>‚úÖ Modelo de datos independiente</li>
                    <li>‚úÖ C√≥digo m√°s mantenible</li>
                </ul>
                <button id="goToEditorBtn" class="bg-white text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                    ‚úçÔ∏è Ir a escribir mi soluci√≥n
                </button>
            </div>
        </div>

        <!-- Solution Modal -->
        <div id="solutionModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-gradient-to-br from-purple-600 to-indigo-700 p-6 rounded-2xl max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-white">üëÅÔ∏è Soluci√≥n Completa</h3>
                    <button id="closeSolutionBtn" class="text-white hover:text-gray-300 text-2xl">&times;</button>
                </div>
                <pre class="text-purple-100 text-sm font-mono bg-purple-900 bg-opacity-50 p-4 rounded overflow-x-auto"><code># C√≥digo aplicando Controller
# --- Modelos ---
class Order:
    def __init__(self, customer, item):
        self.customer = customer
        self.item = item

# --- Controladores ---
class OrderController:
    def take_order(self):
        name = input("üë§ Ingrese su nombre: ")
        item = input("üçΩÔ∏è ¬øQu√© desea ordenar (Pizza / Pasta / Ensalada)? ")
        return Order(name, item)

class KitchenController:
    def prepare_order(self, order):
        print(f"üë®‚Äçüç≥ Preparando {order.item} para {order.customer}...")

class BillingController:
    def generate_bill(self, order):
        print(f"üßæ Factura generada para {order.customer} por {order.item}")

class RestaurantController:
    def __init__(self):
        self.order_controller = OrderController()
        self.kitchen_controller = KitchenController()
        self.billing_controller = BillingController()

    def process_order(self):
        order = self.order_controller.take_order()
        self.kitchen_controller.prepare_order(order)
        self.billing_controller.generate_bill(order)
        print("‚úÖ Pedido completado.")

# Uso
restaurant = RestaurantController()
restaurant.process_order()</code></pre>
            </div>
        </div>

        <!-- Secci√≥n de Respuesta con Monaco Editor para Controller -->


        <!-- Secci√≥n de Respuesta con Monaco Editor para ISP -->
        <div id="ispSection" class="mt-12 bg-gradient-to-br from-gray-900 to-gray-800 p-6 rounded-xl border border-gray-700 max-w-3xl mx-auto hidden">
          <h2 class="text-xl font-bold text-white mb-2 flex items-center">
            <span class="text-2xl mr-2">üîó</span>
            Escribe tu soluci√≥n ISP aqu√≠
          </h2>
          <div id="ispEditor" style="height:300px;border-radius:8px;border:1px solid #334155;"></div>
          <button onclick="checkISP()" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-lg font-semibold transition-colors">
            Evaluar mi soluci√≥n ISP
          </button>
          <div id="ispFeedback" class="mt-4 text-sm bg-gray-700 text-white p-3 rounded"></div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>
        <script>
          let controllerEditor, ispEditor;

          // Configurar Monaco
          require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs' }});
          require(["vs/editor/editor.main"], function () {
            controllerEditor = monaco.editor.create(document.getElementById("controllerEditor"), {
              value: "# Escribe aqu√≠ tu c√≥digo refactorizado usando Controller...",
              language: "python",
              theme: "vs-dark",
              fontSize: 14,
              automaticLayout: true
            });

            ispEditor = monaco.editor.create(document.getElementById("ispEditor"), {
              value: "# Escribe aqu√≠ tu c√≥digo refactorizado usando ISP...",
              language: "python",
              theme: "vs-dark",
              fontSize: 14,
              automaticLayout: true
            });
          });

          // Evaluador simple para patr√≥n Controller
          function checkController() {
            const code = controllerEditor.getValue();
            let feedback = [];

            if (code.includes("input(") && !code.includes("Controller")) {
              feedback.push("<span class='text-red-400'>‚ùå input() fuera de un Controller.</span>");
            } else {
              feedback.push("<span class='text-green-400'>‚úÖ Manejo correcto de input().</span>");
            }

            if (code.match(/print\(.*factura/i)) {
              feedback.push("<span class='text-green-400'>‚úÖ Se genera factura correctamente.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è No se detecta generaci√≥n de factura.</span>");
            }

            if (code.includes("class RestaurantController")) {
              feedback.push("<span class='text-green-400'>‚úÖ Se detecta RestaurantController como orquestador.</span>");
            } else {
              feedback.push("<span class='text-red-400'>‚ùå No se detecta RestaurantController.</span>");
            }

            if (code.includes("class OrderController") && code.includes("class KitchenController") && code.includes("class BillingController")) {
              feedback.push("<span class='text-green-400'>‚úÖ Separaci√≥n de responsabilidades detectada.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è Faltan controladores espec√≠ficos.</span>");
            }

            // NUEVO: Verificar el uso correcto al final
            if (
              code.match(/restaurant\s*=\s*RestaurantController\s*\(\s*\)/) &&
              code.match(/restaurant\.process_order\s*\(\s*\)/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ Se detecta el uso correcto de RestaurantController.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è No se detecta el uso de RestaurantController al final.</span>");
            }

            document.getElementById("controllerFeedback").innerHTML = feedback.join("<br>");
          }

          // Evaluador simple para ISP
          function checkISP() {
            const code = ispEditor.getValue();
            let feedback = [];

            // Debe haber clases Printer, Scanner y Fax
            if (
              code.match(/class\s+Printer\b/) &&
              code.match(/class\s+Scanner\b/) &&
              code.match(/class\s+Fax\b/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ Se detectan interfaces Printer, Scanner y Fax.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è Faltan interfaces Printer, Scanner o Fax.</span>");
            }

            // Debe haber clase SimplePrinter que solo implemente print_document
            if (
              code.match(/class\s+SimplePrinter\s*\(\s*Printer\s*\)/) &&
              code.match(/def\s+print_document\(.*\):/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ SimplePrinter implementa correctamente print_document.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è SimplePrinter no implementa correctamente print_document.</span>");
            }

            // Debe haber clase MultiFunctionPrinter que herede de Printer, Scanner, Fax
            if (
              code.match(/class\s+MultiFunctionPrinter\s*\(\s*Printer\s*,\s*Scanner\s*,\s*Fax\s*\)/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ MultiFunctionPrinter hereda de Printer, Scanner y Fax.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è MultiFunctionPrinter no hereda correctamente de las interfaces.</span>");
            }

            // Debe haber uso de SimplePrinter y MultiFunctionPrinter
            if (
              code.match(/printer\s*=\s*SimplePrinter\s*\(\s*\)/) &&
              code.match(/printer\.print_document\s*\(/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ Se detecta el uso de SimplePrinter.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è No se detecta el uso de SimplePrinter.</span>");
            }

            if (
              code.match(/mfp\s*=\s*MultiFunctionPrinter\s*\(\s*\)/) &&
              code.match(/mfp\.print_document\s*\(/) &&
              code.match(/mfp\.scan_document\s*\(/) &&
              code.match(/mfp\.fax_document\s*\(/)
            ) {
              feedback.push("<span class='text-green-400'>‚úÖ Se detecta el uso de MultiFunctionPrinter con todos sus m√©todos.</span>");
            } else {
              feedback.push("<span class='text-yellow-400'>‚ö†Ô∏è No se detecta el uso completo de MultiFunctionPrinter.</span>");
            }

            document.getElementById("ispFeedback").innerHTML = feedback.join("<br>");
          }
        </script>
    </div>

    <script>
        const controllerFragments = [
            {
                id: 1,
                code: `class Order:
    def __init__(self, customer, item):
        self.customer = customer
        self.item = item`,
                target: 'drop1'
            },
            {
                id: 2,
                code: `class OrderController:
    def take_order(self):
        name = input("üë§ Ingrese su nombre: ")
        item = input("üçΩÔ∏è ¬øQu√© desea ordenar (Pizza / Pasta / Ensalada)? ")
        return Order(name, item)`,
                target: 'drop2'
            },
            {
                id: 3,
                code: `class KitchenController:
    def prepare_order(self, order):
        print(f"üë®‚Äçüç≥ Preparando {order.item} para {order.customer}...")`,
                target: 'drop3'
            },
            {
                id: 4,
                code: `class BillingController:
    def generate_bill(self, order):
        print(f"üßæ Factura generada para {order.customer} por {order.item}")`,
                target: 'drop4'
            },
            {
                id: 5,
                code: `class RestaurantController:
    def __init__(self):
        self.order_controller = OrderController()
        self.kitchen_controller = KitchenController()
        self.billing_controller = BillingController()`,
                target: 'drop5'
            },
            {
                id: 6,
                code: `    def process_order(self):
        order = self.order_controller.take_order()
        self.kitchen_controller.prepare_order(order)
        self.billing_controller.generate_bill(order)
        print("‚úÖ Pedido completado.")`,
                target: 'drop6'
            },
            {
                id: 7,
                code: `restaurant = RestaurantController()
restaurant.process_order()`,
                target: 'drop7'
            }
        ];

        const ispFragments = [
            {
                id: 1,
                code: `class Printer:
    def print_document(self, text):
        pass`,
                target: 'drop1'
            },
            {
                id: 2,
                code: `class Scanner:
    def scan_document(self):
        pass`,
                target: 'drop2'
            },
            {
                id: 3,
                code: `class Fax:
    def fax_document(self, number):
        pass`,
                target: 'drop3'
            },
            {
                id: 4,
                code: `class SimplePrinter(Printer):
    def print_document(self, text):
        print(f"üñ®Ô∏è Imprimiendo: {text}")`,
                target: 'drop4'
            },
            {
                id: 5,
                code: `class MultiFunctionPrinter(Printer, Scanner, Fax):
    def print_document(self, text):
        print(f"üñ®Ô∏è Imprimiendo: {text}")
    def scan_document(self):
        print("üì† Escaneando documento...")
    def fax_document(self, number):
        print(f"üì° Enviando fax al n√∫mero {number}...")`,
                target: 'drop5'
            },
            {
                id: 6,
                code: `print("=== Simple Printer ===")
printer = SimplePrinter()
printer.print_document("Contrato laboral")`,
                target: 'drop6'
            },
            {
                id: 7,
                code: `print("\\n=== Multi Function Printer ===")
mfp = MultiFunctionPrinter()
mfp.print_document("Informe financiero")
mfp.scan_document()
mfp.fax_document("321654987")`,
                target: 'drop7'
            }
        ];

        let currentActivity = 'controller';
        let codeFragments = controllerFragments;

        let completedFragments = 0;
        let draggedElement = null;

        function switchActivity(activity) {
            currentActivity = activity;
            if (activity === 'controller') {
                codeFragments = controllerFragments;
                document.getElementById('subtitle').textContent = 'Transforma el c√≥digo malo aplicando el patr√≥n Controller';
                updateBadCodeSection('controller');
                updateGoodCodeSection('controller');
                // Mostrar solo secci√≥n Controller
                document.getElementById('controllerSection').classList.remove('hidden');
                document.getElementById('ispSection').classList.add('hidden');
            } else {
                codeFragments = ispFragments;
                document.getElementById('subtitle').textContent = 'Transforma el c√≥digo malo aplicando el principio ISP';
                updateBadCodeSection('isp');
                updateGoodCodeSection('isp');
                // Mostrar solo secci√≥n ISP
                document.getElementById('controllerSection').classList.add('hidden');
                document.getElementById('ispSection').classList.remove('hidden');
            }
            initGame();
        }

        function updateBadCodeSection(type) {
            const badCodeContent = type === 'controller' ? 
                `# C√≥digo sin aplicar Controller
class Restaurant:
    def take_order(self):
        name = input("üë§ Ingrese su nombre: ")
        item = input("üçΩÔ∏è ¬øQu√© desea ordenar (Pizza / Pasta / Ensalada)? ")
        print(f"Cliente {name} orden√≥ {item}")
        
        # Cocina
        print(f"Preparando {item} en la cocina...")
        
        # Factura
        print(f"Generando factura para {name} por {item}...")
        print("‚úÖ Pedido completado.")

# Uso
restaurant = Restaurant()
restaurant.take_order()` :
                `# C√≥digo sin aplicar ISP
class Machine:
    def print_document(self, text):
        pass
    def scan_document(self):
        pass
    def fax_document(self, number):
        pass

class SimplePrinter(Machine):
    def print_document(self, text):
        print(f"üñ®Ô∏è Imprimiendo: {text}")
    def scan_document(self):
        # M√©todo in√∫til
        print("‚ùå Esta impresora no puede escanear.")
    def fax_document(self, number):
        # M√©todo in√∫til
        print("‚ùå Esta impresora no puede enviar fax.")

# Uso
printer = SimplePrinter()
printer.print_document("Contrato laboral")
printer.scan_document()   # Error l√≥gico
printer.fax_document("123456") # Error l√≥gico`;

            const badCodeElement = document.querySelector('.bg-gradient-to-br.from-red-900 pre code');
            badCodeElement.textContent = badCodeContent;
        }

        function updateGoodCodeSection(type) {
            const goodCodeElement = document.getElementById('goodCode');
            if (type === 'controller') {
                goodCodeElement.innerHTML = `# C√≥digo aplicando Controller
# --- Modelos ---
<div id="drop1" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra el modelo aqu√≠</span>
</div>

# --- Controladores ---
<div id="drop2" class="drop-zone inline-block min-w-[200px] min-h-[80px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra un controlador aqu√≠</span>
</div>

<div id="drop3" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra un controlador aqu√≠</span>
</div>

<div id="drop4" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra un controlador aqu√≠</span>
</div>

<div id="drop5" class="drop-zone inline-block min-w-[200px] min-h-[120px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra un controlador aqu√≠</span>
</div>

<div id="drop6" class="drop-zone inline-block min-w-[200px] min-h-[80px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra un controlador aqu√≠</span>
</div>

# Uso
<div id="drop7" class="drop-zone inline-block min-w-[200px] min-h-[40px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra el uso final aqu√≠</span>
</div>`;
            } else {
                goodCodeElement.innerHTML = `# C√≥digo aplicando ISP
# --- Interfaces separadas ---
<div id="drop1" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra interface Printer aqu√≠</span>
</div>

<div id="drop2" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra interface Scanner aqu√≠</span>
</div>

<div id="drop3" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra interface Fax aqu√≠</span>
</div>

# Clases concretas
<div id="drop4" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra SimplePrinter aqu√≠</span>
</div>

<div id="drop5" class="drop-zone inline-block min-w-[200px] min-h-[120px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra MultiFunctionPrinter aqu√≠</span>
</div>

# Uso
<div id="drop6" class="drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra uso SimplePrinter aqu√≠</span>
</div>

<div id="drop7" class="drop-zone inline-block min-w-[200px] min-h-[80px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600">
    <span class="text-gray-400 text-xs">Arrastra uso MultiFunctionPrinter aqu√≠</span>
</div>`;
            }
        }

        function initGame() {
            completedFragments = 0;
            updateProgress();
            renderFragments();
            resetDropZones();
        }

        function renderFragments() {
            const container = document.getElementById('codeFragments');
            container.innerHTML = '';
            
            // Mezclar fragmentos
            const shuffled = [...codeFragments].sort(() => Math.random() - 0.5);
            
            shuffled.forEach((fragment, index) => {
                const div = document.createElement('div');
                div.className = 'code-snippet p-3 rounded-lg cursor-move select-none slide-in';
                div.style.animationDelay = `${index * 0.1}s`;
                div.draggable = true;
                div.dataset.id = fragment.id;
                div.dataset.target = fragment.target;
                
                div.innerHTML = `
                    <div class="flex items-start">
                        <span class="text-blue-400 text-lg mr-2">üìù</span>
                        <pre class="text-gray-200 text-xs font-mono flex-1 overflow-x-auto">${fragment.code}</pre>
                    </div>
                `;
                
                div.addEventListener('dragstart', handleDragStart);
                div.addEventListener('dragend', handleDragEnd);
                
                container.appendChild(div);
            });
        }

        function resetDropZones() {
            for (let i = 1; i <= 7; i++) {
                const dropZone = document.getElementById(`drop${i}`);
                dropZone.className = 'drop-zone inline-block min-w-[200px] min-h-[60px] p-2 rounded border-2 border-dashed border-gray-400 bg-gray-600';
                dropZone.innerHTML = `<span class="text-gray-400 text-xs">${getDropZoneText(i)}</span>`;
                
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);
                dropZone.addEventListener('dragleave', handleDragLeave);
            }
        }

        function getDropZoneText(dropNumber) {
            if (currentActivity === 'controller') {
                const texts = {
                    1: 'Arrastra el modelo aqu√≠',
                    2: 'Arrastra un controlador aqu√≠',
                    3: 'Arrastra un controlador aqu√≠',
                    4: 'Arrastra un controlador aqu√≠',
                    5: 'Arrastra un controlador aqu√≠',
                    6: 'Arrastra un controlador aqu√≠',
                    7: 'Arrastra el uso final aqu√≠'
                };
                return texts[dropNumber];
            } else {
                const texts = {
                    1: 'Arrastra interface Printer aqu√≠',
                    2: 'Arrastra interface Scanner aqu√≠',
                    3: 'Arrastra interface Fax aqu√≠',
                    4: 'Arrastra SimplePrinter aqu√≠',
                    5: 'Arrastra MultiFunctionPrinter aqu√≠',
                    6: 'Arrastra uso SimplePrinter aqu√≠',
                    7: 'Arrastra uso MultiFunctionPrinter aqu√≠'
                };
                return texts[dropNumber];
            }
        }

        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.target.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.target.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target;
            dropZone.classList.remove('drag-over');

            // Identificar si estamos en la actividad controller y en zona de controladores
            const controllerDropIds = ['drop2', 'drop3', 'drop4', 'drop5', 'drop6'];
            if (
                currentActivity === 'controller' &&
                controllerDropIds.includes(dropZone.id)
            ) {
                // Solo aceptar fragmentos de controladores (id 2 a 6) en cualquier orden
                if (
                    draggedElement &&
                    [2, 3, 4, 5, 6].includes(Number(draggedElement.dataset.id)) &&
                    !dropZone.classList.contains('filled')
                ) {
                    const fragment = codeFragments.find(f => f.id == draggedElement.dataset.id);

                    dropZone.classList.add('filled', 'pulse-success', 'glow');
                    dropZone.innerHTML = `<pre class="text-green-100 text-xs font-mono">${fragment.code}</pre>`;

                    draggedElement.style.display = 'none';
                    completedFragments++;
                    updateProgress();

                    if (completedFragments === codeFragments.length) {
                        setTimeout(() => {
                            document.getElementById('successModal').classList.remove('hidden');
                        }, 1000);
                    }
                    return;
                }
            }

            // Comportamiento normal para el resto de zonas
            if (draggedElement && dropZone.id === draggedElement.dataset.target && !dropZone.classList.contains('filled')) {
                const fragment = codeFragments.find(f => f.id == draggedElement.dataset.id);

                dropZone.classList.add('filled', 'pulse-success', 'glow');
                dropZone.innerHTML = `<pre class="text-green-100 text-xs font-mono">${fragment.code}</pre>`;

                draggedElement.style.display = 'none';
                completedFragments++;
                updateProgress();

                if (completedFragments === codeFragments.length) {
                    setTimeout(() => {
                        document.getElementById('successModal').classList.remove('hidden');
                    }, 1000);
                }
            } else {
                dropZone.classList.add('shake');
                setTimeout(() => {
                    dropZone.classList.remove('shake');
                }, 500);
            }
        }

        function updateProgress() {
            const percentage = (completedFragments / codeFragments.length) * 100;
            document.getElementById('progressBar').style.width = `${percentage}%`;
            document.getElementById('progressText').textContent = `${completedFragments}/${codeFragments.length} completado`;
        }

        function showHint() {
            const hintContent = document.getElementById('hintPanel');
            const hintText = hintContent.querySelector('h3');
            const hintBody = hintContent.querySelector('.grid');
            
            if (currentActivity === 'controller') {
                hintText.innerHTML = 'üí° Pista - Patr√≥n Controller';
                hintBody.innerHTML = `
                    <div>
                        <h4 class="text-red-400 font-bold mb-2">‚ùå Problema Actual:</h4>
                        <ul class="text-red-200 space-y-1">
                            <li>‚Ä¢ Una sola clase hace todo</li>
                            <li>‚Ä¢ Mezcla UI, l√≥gica y datos</li>
                            <li>‚Ä¢ Dif√≠cil de mantener y testear</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-green-400 font-bold mb-2">‚úÖ Soluci√≥n Controller:</h4>
                        <ul class="text-green-200 space-y-1">
                            <li>‚Ä¢ Separar responsabilidades</li>
                            <li>‚Ä¢ Crear controladores espec√≠ficos</li>
                            <li>‚Ä¢ Usar modelos para datos</li>
                        </ul>
                    </div>
                `;
            } else {
                hintText.innerHTML = 'üí° Pista - Principio ISP';
                hintBody.innerHTML = `
                    <div>
                        <h4 class="text-red-400 font-bold mb-2">‚ùå Problema Actual:</h4>
                        <ul class="text-red-200 space-y-1">
                            <li>‚Ä¢ Interface muy grande</li>
                            <li>‚Ä¢ Clases implementan m√©todos in√∫tiles</li>
                            <li>‚Ä¢ Violaci√≥n del principio ISP</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-green-400 font-bold mb-2">‚úÖ Soluci√≥n ISP:</h4>
                        <ul class="text-green-200 space-y-1">
                            <li>‚Ä¢ Interfaces peque√±as y espec√≠ficas</li>
                            <li>‚Ä¢ Cada clase implementa solo lo que necesita</li>
                            <li>‚Ä¢ Mayor flexibilidad y mantenibilidad</li>
                        </ul>
                    </div>
                `;
            }
            
            hintContent.classList.toggle('hidden');
        }

        function showSolution() {
            const solutionCode = document.querySelector('#solutionModal pre code');

            if (currentActivity === 'controller') {
                solutionCode.textContent = `# C√≥digo aplicando Controller
# --- Modelos ---
class Order:
    def __init__(self, customer, item):
        self.customer = customer
        self.item = item

# --- Controladores ---
class OrderController:
    def take_order(self):
        name = input("üë§ Ingrese su nombre: ")
        item = input("üçΩÔ∏è ¬øQu√© desea ordenar (Pizza / Pasta / Ensalada)? ")
        return Order(name, item)

class KitchenController:
    def prepare_order(self, order):
        print(f"üë®‚Äçüç≥ Preparando {order.item} para {order.customer}...")

class BillingController:
    def generate_bill(self, order):
        print(f"üßæ Factura generada para {order.customer} por {order.item}")

class RestaurantController:
    def __init__(self):
        self.order_controller = OrderController()
        self.kitchen_controller = KitchenController()
        self.billing_controller = BillingController()

    def process_order(self):
        order = self.order_controller.take_order()
        self.kitchen_controller.prepare_order(order)
        self.billing_controller.generate_bill(order)
        print("‚úÖ Pedido completado.")

# Uso
restaurant = RestaurantController()
restaurant.process_order()`;
            } else {
                solutionCode.textContent = `# C√≥digo aplicando ISP
# --- Interfaces separadas ---
class Printer:
    def print_document(self, text):
        pass

class Scanner:
    def scan_document(self):
        pass

class Fax:
    def fax_document(self, number):
        pass

# Clases concretas
class SimplePrinter(Printer):
    def print_document(self, text):
        print(f"üñ®Ô∏è Imprimiendo: ${text}")


class MultiFunctionPrinter(Printer, Scanner, Fax):
    def print_document(self, text):
        print(f"üñ®Ô∏è Imprimiendo: ${text}")

    def scan_document(self):
        print("üì† Escaneando documento...")

    def fax_document(self, number):
        print(f"üì° Enviando fax al n√∫mero ${number}...")

# Uso
print("=== Simple Printer ===")
printer = SimplePrinter()
printer.print_document("Contrato laboral")

print("\\n=== Multi Function Printer ===")
mfp = MultiFunctionPrinter()
mfp.print_document("Informe financiero")
mfp.scan_document()
mfp.fax_document("321654987")`;
            }
            
            document.getElementById('solutionModal').classList.remove('hidden');
        }

        function closeSolution() {
            document.getElementById('solutionModal').classList.add('hidden');
        }

        // Event Listeners
        document.getElementById('controllerBtn').addEventListener('click', () => {
            switchActivity('controller');
            document.getElementById('controllerBtn').classList.add('bg-blue-600');
            document.getElementById('controllerBtn').classList.remove('bg-blue-500');
            document.getElementById('ispBtn').classList.add('bg-indigo-500');
            document.getElementById('ispBtn').classList.remove('bg-indigo-600');
        });
        
        document.getElementById('ispBtn').addEventListener('click', () => {
            switchActivity('isp');
            document.getElementById('ispBtn').classList.add('bg-indigo-600');
            document.getElementById('ispBtn').classList.remove('bg-indigo-500');
            document.getElementById('controllerBtn').classList.add('bg-blue-500');
            document.getElementById('controllerBtn').classList.remove('bg-blue-600');
        });
        
        document.getElementById('showHintBtn').addEventListener('click', showHint);
        document.getElementById('resetBtn').addEventListener('click', () => {
            initGame();
            // Limpiar Monaco Editor y feedbacks
            if (window.controllerEditor) {
                controllerEditor.setValue("# Escribe aqu√≠ tu c√≥digo refactorizado usando Controller...");
                document.getElementById('controllerFeedback').innerHTML = "";
            }
            if (window.ispEditor) {
                ispEditor.setValue("# Escribe aqu√≠ tu c√≥digo refactorizado usando ISP...");
                document.getElementById('ispFeedback').innerHTML = "";
            }
        });
        document.getElementById('closeSolutionBtn').addEventListener('click', closeSolution);
        document.getElementById('goToEditorBtn').addEventListener('click', () => {
            document.getElementById('successModal').classList.add('hidden');
            // Scroll suave a la secci√≥n del editor
            const editorSection = document.getElementById('controllerEditor');
            if (editorSection) {
                editorSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Opcional: enfocar el editor Monaco si est√° disponible
                setTimeout(() => {
                    if (window.controllerEditor) controllerEditor.focus();
                }, 600);
            }
        });
        document.getElementById('minimizeSuccessBtn').addEventListener('click', () => {
            document.getElementById('successModal').classList.add('hidden');
        });

        // Inicializar con Controller activo
        document.getElementById('controllerBtn').classList.add('bg-blue-600');
document.getElementById('controllerBtn').classList.remove('bg-blue-500');
switchActivity('controller'); // <-- Asegura que siempre inicia en Controller
initGame();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97889742a39316ac',t:'MTc1Njc2OTc5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
